<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Spirit Chat</title>
    <link rel="stylesheet" type="text/css" href="../static/css/page-chat.css">
    <link rel="icon" type="image/png" href="../static/img/logo_E-esprit.png">
    <script src="../static/js/main.js"></script>
    <script src="../static/js/theme.js"></script> 
    <script src="../static/js/profil.js"></script>
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <script>
        var current_user = { id: {{ current_user.id | tojson }} };
    </script>
</head>
<body class="slide-out" data-page="page3">
    <header>
        <img src="data:image/png;base64,{{ avatar_data.avatar }}" alt="Photo" class="ta-pp">
        <h2 class="username"> {{ current_user.username }} </h2>
        <div class="Name-page">Chat</div>
        <button class="header-button" id="open-dialog-button">
            <img src="../static/img/coin_E-esprit.png" alt="coin_E-esprit" class="ta-pp">
        </button>
    </header>



    <dialog id="my-dialog">
        <div class="dialog-header">
            <h2>Titre du dialogue</h2>
            <span class="close">&times;</span>
        </div>
        <div class="dialog-content">
            <p>Contenu de la fenêtre</p><!-- Contenu du dialogue -->
        </div>
    </dialog>








    {% block content %}
    <div>
        {% for friend in friends %}
            <ul class="conversation">
                <div class="chat">
                    <img src="data:image/png;base64,{{ friend.avatar }}" alt="pp" class="profilespictures">
                    <div class="chat-info">
                        <a href="{{ url_for('chat_with_user', user_id=friend.friend_id) }}"><span class="chat-name">{{ friend.username }}</span></a>
                        <div class="no-wrap">
                            <span class="chat-temps">temps</span>   
                            <span class="chat-message">/ Cet endroit corespo...</span>
                        </div>
                    </div>
                    <div class="reglage-button" onclick="handleReglageClick()">
                        <img src="../static/img/trois-points-plus-indicateur.png" alt="reglage" class="reglage">
                    </div>
                </div>
            </ul>
        {% endfor %}
    </div>
    {% endblock %}


    <footer>
        <button class="footer-button" onclick="pageamis()"><img src="../static/img/amis.png" alt="icone-friends" class="icone-friends"></button>
        <button class="footer-button" onclick="pagecam()"><img src="../static/img/camera.png" alt="icone-cam" class="icone-cam"></button>
        <button class="footer-button" onclick="pagechat()"><img src="../static/img/icons8-bulle-50.png" alt="icone-discu" class="icone-discu"></button>
        <button class="footer-button" onclick="pagealbum()"><img src="../static/img/album-photo.png" alt="icone-album" class="icone-album"></button>
        <button class="footer-button" onclick="pageparametre()"><img src="../static/img/parametres.png" alt="icone-setting" class="icone-setting"></button>
    </footer>
   
    <div id="account-info-popup" class="popup hidden">
        <div class="popup-content">
            <span id="close-popup" class="close">&times;</span>
            <img src="data:image/png;base64,{{ avatar_data.avatar }}" alt="photo" class="profil">
            <h2>Informations du Compte</h2>
            <p id="username"></p>
            <p id="userNom">Nom : ...</p>
            <p id="userPrenom">Prénom : ...</p>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/online.js') }}"></script>   
    <script>
        const dialog = document.getElementById('my-dialog');
        const openButton = document.getElementById('open-dialog-button');
        const closeButton = document.getElementById('close-dialog-button');
        
        openButton.addEventListener('click', () => {
            dialog.showModal();
        });
        
        closeButton.addEventListener('click', () => {
            dialog.close();
        });
    </script>

</body>
</html>
